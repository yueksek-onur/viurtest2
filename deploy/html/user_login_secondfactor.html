{%- extends "viur_base.html" %}

{%- block content %}
	{% if action == "otp" %}
		<h1 class="headline">OTP</h1>

		<form action="/user/f2_timebasedotp/otp" method="POST" class="">
			<input name="skey" type="hidden" value="{{ getSecurityKey() }}">

			<div class="msg msg--error {{ "is-active" if secondFactorFailed }}">
				{{ embedSvg("icon-cross") }}
				<div class="msg-content">
					<h3 class="msg-headline">Error!</h3>
					<p>The entered token was invaild!</p>
				</div>
			</div>

			<div class="input-group">
				<label class="label has-icon" for="otptoken">{{ embedSvg("icon-token") }}OTP Token</label>
				<input id="username" name="otptoken" type="text" class="input js-focus" placeholder="OTP Token">
			</div>

			<button type="submit" id="submitbtn" name="submit" class="btn btn--primary">Login</button>
		</form>
	{% else %}
		<div>Unimplemented second factor action: {{ action }}</div>
	{% endif %}
{%- endblock content %}
